! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
! 
! Global Data Module File
! 
! Generated by KPP-2.2.3 symbolic chemistry Kinetics PreProcessor
!       (http://www.cs.vt.edu/~asandu/Software/KPP)
! KPP is distributed under GPL, the general public licence
!       (http://www.gnu.org/copyleft/gpl.html)
! (C) 1995-1997, V. Damian & A. Sandu, CGRER, Univ. Iowa
! (C) 1997-2005, A. Sandu, Michigan Tech, Virginia Tech
!     With important contributions from:
!        M. Damian, Villanova University, USA
!        R. Sander, Max-Planck Institute for Chemistry, Mainz, Germany
! 
! File                 : kpp_Global.f90
! Time                 : Mon Oct 13 15:31:12 2014
! Working directory    : /scratch/daint/charlesj/extended_box_model/kpp-2.2.3
! Equation file        : kpp.kpp
! Output root filename : kpp
! 
! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

MODULE kpp_Global

  USE kpp_Parameters, ONLY: dp, NSPEC, NVAR, NFIX, NREACT, idim, jdim, kdim, ncells
  PUBLIC
  SAVE

! Declaration of global variables

  INTEGER :: CLOCK_RATE, CLOCK_MAX

  INTEGER :: CLOCK_TS,         CLOCK_TS_1,         CLOCK_TS_2
  INTEGER :: CLOCK_INTEGRATOR, CLOCK_INTEGRATOR_1, CLOCK_INTEGRATOR_2

  INTEGER :: CLOCK_INTEGRATOR_INIT, CLOCK_INTEGRATOR_INIT_1, CLOCK_INTEGRATOR_INIT_2
  INTEGER :: CLOCK_INTEGRATOR_SAVE, CLOCK_INTEGRATOR_SAVE_1, CLOCK_INTEGRATOR_SAVE_2
  INTEGER :: CLOCK_INTEGRATOR_CORE, CLOCK_INTEGRATOR_CORE_1, CLOCK_INTEGRATOR_CORE_2

#ifdef DETAILED_TIMING
  INTEGER :: CLOCK_LU, CLOCK_LU_1, CLOCK_LU_2
  !$OMP THREADPRIVATE(CLOCK_LU_1, CLOCK_LU_2)
  !REAL(kind=dp) :: CLOCK_LU, CLOCK_LU_1, CLOCK_LU_2
  INTEGER :: CLOCK_LU_CALLS

  INTEGER :: CLOCK_LU_FULL, CLOCK_LU_FULL_1, CLOCK_LU_FULL_2
  !$OMP THREADPRIVATE(CLOCK_LU_FULL_1, CLOCK_LU_FULL_2)
  !REAL(kind=dp) :: CLOCK_LU_FULL, CLOCK_LU_FULL_1, CLOCK_LU_FULL_2
  INTEGER :: CLOCK_LU_FULL_CALLS

  INTEGER :: CLOCK_TEST_FULL, CLOCK_TEST_FULL_1, CLOCK_TEST_FULL_2
  !$OMP THREADPRIVATE(CLOCK_TEST_FULL_1, CLOCK_TEST_FULL_2)
#endif

#ifdef FINE_TIMING
  INTEGER :: CLOCK_PREPAREMATRIX_FULL, CLOCK_PREPAREMATRIX_FULL_1, CLOCK_PREPAREMATRIX_FULL_2
  !$OMP THREADPRIVATE(CLOCK_PREPAREMATRIX_FULL_1, CLOCK_PREPAREMATRIX_FULL_2)

  INTEGER :: CLOCK_AXPY, CLOCK_AXPY_1, CLOCK_AXPY_2
  !$OMP THREADPRIVATE(CLOCK_AXPY_1, CLOCK_AXPY_2)

  INTEGER :: CLOCK_KPPSOLVE, CLOCK_KPPSOLVE_1, CLOCK_KPPSOLVE_2
  !$OMP THREADPRIVATE(CLOCK_KPPSOLVE_1, CLOCK_KPPSOLVE_2)

  INTEGER :: CLOCK_FUNTEMPLATE, CLOCK_FUNTEMPLATE_1, CLOCK_FUNTEMPLATE_2
  !$OMP THREADPRIVATE(CLOCK_FUNTEMPLATE_1, CLOCK_FUNTEMPLATE_2)

  INTEGER :: CLOCK_JACTEMPLATE, CLOCK_JACTEMPLATE_1, CLOCK_JACTEMPLATE_2
  !$OMP THREADPRIVATE(CLOCK_JACTEMPLATE_1, CLOCK_JACTEMPLATE_2)
#endif

! Concentrations of all species for the whole domain
  REAL :: initial_conc_from_file(idim, jdim, kdim, NSPEC)
  REAL :: vinitial_conc_from_file(ncells, NSPEC)
! Temperatures of all species for the whole domain
  REAL :: temperature_from_file(idim, jdim, kdim)
  REAL :: vtemperature_from_file(ncells)
! C - Concentration of all species
  REAL(kind=dp) :: C(NSPEC)
! VAR - Concentrations of variable species (global)
  REAL(kind=dp) :: VARTOT(NVAR,idim,jdim,kdim)
  REAL(kind=dp) :: VVARTOT(NVAR,ncells)
  REAL(kind=dp) :: VAR(NVAR)
! FIX - Concentrations of fixed species (global)
  REAL(kind=dp) :: FIX(NFIX)
! VAR, FIX are chunks of array C
      EQUIVALENCE( C(1),VAR(1) )
      EQUIVALENCE( C(83),FIX(1) )
! RCONST - Rate constants (global)
  REAL(kind=dp) :: RCONST(NREACT)
  !$OMP THREADPRIVATE(RCONST)
! TIME - Current integration time
  REAL(kind=dp) :: TIME
  !$OMP THREADPRIVATE(TIME)
! SUN - Sunlight intensity between [0,1]
  REAL(kind=dp) :: SUN
! TEMP - Temperature
  REAL(kind=dp) :: TEMP
  !$OMP THREADPRIVATE(TEMP)
! RTOLS - (scalar) Relative tolerance
  REAL(kind=dp) :: RTOLS
! TSTART - Integration start time
  REAL(kind=dp) :: TSTART_INT
! TEND - Integration end time
  REAL(kind=dp) :: TEND_INT
! DT - Integration step
  REAL(kind=dp) :: DT
! ATOL - Absolute tolerance
  REAL(kind=dp) :: ATOL(NVAR)
! RTOL - Relative tolerance
  REAL(kind=dp) :: RTOL(NVAR)
! STEPMIN - Lower bound for integration step
  REAL(kind=dp) :: STEPMIN
  !$OMP THREADPRIVATE(STEPMIN)
! STEPMAX - Upper bound for integration step
  REAL(kind=dp) :: STEPMAX
! CFACTOR - Conversion factor for concentration units
  REAL(kind=dp) :: CFACTOR
! Integrator statistics
  INTEGER*8 :: ISTATS(8), global_ISTATS(8)

! INLINED global variable declarations

  REAL(kind=dp) :: CHI
  REAL(kind=dp) :: M

! INLINED global variable declarations


END MODULE kpp_Global

